# Docker ê°œë°œ í™˜ê²½ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”
ë¡œì»¬ ê°œë°œì„ ìœ„í•œ Docker Compose í™˜ê²½ ì„¤ì • ê°€ì´ë“œì…ë‹ˆë‹¤.

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

### **ë¡œì»¬ ê°œë°œ í™˜ê²½**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MinIO         â”‚    â”‚   PostgreSQL    â”‚    â”‚   OpenSearch    â”‚
â”‚   (íŒŒì¼ ì €ì¥)    â”‚    â”‚   (Docker)      â”‚    â”‚   (Docker)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   FastAPI App   â”‚
                    â”‚   (Docker)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. í™˜ê²½ë³€ìˆ˜ ì„¤ì •
```bash
# í™˜ê²½ë³€ìˆ˜ íŒŒì¼ ë³µì‚¬
cp docs/í™˜ê²½ë³€ìˆ˜_README.md .env

# ì‹¤ì œ ê°’ìœ¼ë¡œ ìˆ˜ì •
nano .env
```

### 2. ì„œë¹„ìŠ¤ ì‹œì‘
```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ ì‹œì‘
docker-compose up -d

# ë¡œê·¸ í™•ì¸
docker-compose logs -f
```

### 3. ì„œë¹„ìŠ¤ ì¤‘ì§€
```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ ì¤‘ì§€
docker-compose down
```

## ğŸ“Š ì„œë¹„ìŠ¤ ì •ë³´

### **í¬íŠ¸ ë§¤í•‘**
- **FastAPI App**: http://localhost:8010
- **PostgreSQL**: localhost:5432
- **PgAdmin**: http://localhost:5050
- **MinIO Console**: http://localhost:9001
- **OpenSearch**: http://localhost:9200

### **ê¸°ë³¸ ì ‘ì† ì •ë³´**
- **PgAdmin**: admin@admin.com / admin1234
- **MinIO**: minioadmin / minioadmin
- **OpenSearch**: admin / G7!kz@2pQw

## ğŸ”§ ê°œë°œ ë„êµ¬

### **ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬**
```bash
# PostgreSQL ì ‘ì†
docker exec -it postgres psql -U myuser -d mydatabase

# PgAdmin ì ‘ì†
# ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:5050 ì ‘ì†
```

### **íŒŒì¼ ì €ì¥ì†Œ ê´€ë¦¬**
```bash
# MinIO Console ì ‘ì†
# ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:9001 ì ‘ì†
```

### **ê²€ìƒ‰ ì—”ì§„ ê´€ë¦¬**
```bash
# OpenSearch ì ‘ì†
curl -u admin:G7!kz@2pQw http://localhost:9200
```

## ğŸ“ í´ë” êµ¬ì¡°

```
docker/
â”œâ”€â”€ README.md              # ì´ íŒŒì¼ (ë¡œì»¬ ê°œë°œ ê°€ì´ë“œ)
â”œâ”€â”€ docker-compose.yml     # ì„œë¹„ìŠ¤ êµ¬ì„±
â”œâ”€â”€ Dockerfile            # ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¯¸ì§€
â”œâ”€â”€ start.sh              # ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ aws/                  # AWS ë°°í¬ ê´€ë ¨ (ë³„ë„ í´ë”)
â”‚   â”œâ”€â”€ README.md         # AWS ê°€ì´ë“œ
â”‚   â”œâ”€â”€ deploy-ecr.sh    # ECR ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ env.template      # AWS í™˜ê²½ë³€ìˆ˜ í…œí”Œë¦¿
â”‚   â””â”€â”€ MIGRATION_GUIDE.md # AWS ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ
â”œâ”€â”€ pgdata/               # PostgreSQL ë°ì´í„°
â”œâ”€â”€ pgadmin_data/         # PgAdmin ë°ì´í„°
â”œâ”€â”€ minio_data/           # MinIO ë°ì´í„°
â””â”€â”€ osdata*/              # OpenSearch ë°ì´í„°
```

## ğŸ› ï¸ ê°œë°œ ì›Œí¬í”Œë¡œìš°

### **1. ì½”ë“œ ìˆ˜ì •**
```bash
# ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ìˆ˜ì •
# app/ í´ë”ì˜ íŒŒì¼ë“¤ì„ ìˆ˜ì •í•˜ë©´ ìë™ìœ¼ë¡œ ë°˜ì˜ë©ë‹ˆë‹¤
```

### **2. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜**
```bash
# ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
docker exec -it fastapi-app alembic upgrade head

# ìƒˆ ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„±
docker exec -it fastapi-app alembic revision --autogenerate -m "ì„¤ëª…"
```

### **3. ë¡œê·¸ í™•ì¸**
```bash
# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸
docker-compose logs fastapi-app
docker-compose logs postgres
docker-compose logs minio
```

### **4. ì„œë¹„ìŠ¤ ì¬ì‹œì‘**
```bash
# íŠ¹ì • ì„œë¹„ìŠ¤ë§Œ ì¬ì‹œì‘
docker-compose restart fastapi-app

# ëª¨ë“  ì„œë¹„ìŠ¤ ì¬ì‹œì‘
docker-compose restart
```

## ğŸ” ë¬¸ì œ í•´ê²°

### **í¬íŠ¸ ì¶©ëŒ**
```bash
# ì‚¬ìš© ì¤‘ì¸ í¬íŠ¸ í™•ì¸
netstat -tulpn | grep :8010

# ë‹¤ë¥¸ í¬íŠ¸ë¡œ ë³€ê²½ (docker-compose.yml ìˆ˜ì •)
ports:
  - "8011:8000"  # 8010 â†’ 8011ë¡œ ë³€ê²½
```

### **ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨**
```bash
# PostgreSQL ìƒíƒœ í™•ì¸
docker-compose ps postgres

# PostgreSQL ë¡œê·¸ í™•ì¸
docker-compose logs postgres
```

### **ë©”ëª¨ë¦¬ ë¶€ì¡±**
```bash
# Docker ë¦¬ì†ŒìŠ¤ í™•ì¸
docker system df

# ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤ ì •ë¦¬
docker system prune -a
```

## ğŸ“š ì¶”ê°€ ë¬¸ì„œ

- **í™˜ê²½ë³€ìˆ˜ ì„¤ì •**: `docs/í™˜ê²½ë³€ìˆ˜_README.md`
- **API ëª…ì„¸ì„œ**: `docs/CHAT_HISTORY_API_SPEC.md`
- **AWS ë°°í¬**: `docker/aws/README.md`
- **JWT ë³´ì•ˆ**: `docs/JWT_SECURITY_GUIDE.md`

## ğŸš¨ ì£¼ì˜ì‚¬í•­

1. **ë°ì´í„° ë°±ì—…**: ì¤‘ìš”í•œ ë°ì´í„°ëŠ” ì •ê¸°ì ìœ¼ë¡œ ë°±ì—…
2. **í™˜ê²½ë³€ìˆ˜**: ë¯¼ê°í•œ ì •ë³´ëŠ” .env íŒŒì¼ì— ì €ì¥
3. **í¬íŠ¸ ê´€ë¦¬**: ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ í¬íŠ¸ ì¶©ëŒ ì£¼ì˜
4. **ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§**: Docker ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸
5. **ë³´ì•ˆ**: ê°œë°œ í™˜ê²½ì´ë¯€ë¡œ í”„ë¡œë•ì…˜ ë³´ì•ˆ ì„¤ì • ì ìš©í•˜ì§€ ì•ŠìŒ 